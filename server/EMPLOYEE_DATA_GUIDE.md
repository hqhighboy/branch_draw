# 员工信息数据库导入与查询指南

本指南将帮助您将Excel表格中的员工信息导入到SQL数据库，并进行查询操作。

## 功能概述

1. **创建数据库表结构**：自动创建适合存储员工信息的数据库表
2. **导入Excel数据**：将Excel表格中的员工信息导入到数据库
3. **查询员工数据**：提供多种方式查询员工信息

## 准备工作

1. **确保MySQL数据库已启动**
2. **确保已安装必要的依赖**：
   ```
   cd D:\Projects\cursor\branch-analysis\server
   npm install xlsx mysql2
   ```

## 使用步骤

### 1. 创建数据库表结构

首先，需要创建数据库表结构：

```
cd D:\Projects\cursor\branch-analysis\server
node scripts/create-employee-table.js
```

这将在数据库中创建一个名为`employees`的表，包含所有必要的字段。

### 2. 导入Excel数据

准备好Excel文件后，运行导入脚本：

```
cd D:\Projects\cursor\branch-analysis\server
node scripts/import-employee-data.js
```

按照提示输入Excel文件的完整路径，例如：`D:\Data\employees.xlsx`

导入过程中会显示进度，完成后会显示导入结果统计。

### 3. 查询员工数据

导入完成后，可以使用查询工具查看和搜索员工数据：

```
cd D:\Projects\cursor\branch-analysis\server
node scripts/query-employees.js
```

查询工具提供以下功能：
- 显示员工总数
- 显示部门分布
- 显示岗位分布
- 显示学历分布
- 显示年龄分布
- 按姓名查询
- 按部门查询
- 按岗位查询
- 按学历查询

## Excel文件格式要求

Excel文件应包含以下字段（字段名称必须与下列完全一致）：

- 员工基本信息-姓名
- 员工基本信息-员工编码
- 员工基本信息-性别
- 员工基本信息-出生日期
- 员工基本信息-年龄
- 员工基本信息-民族
- 员工基本信息-籍贯
- 员工基本信息-工龄
- 员工基本信息-出生地
- 员工基本信息-文化程度
- 员工基本信息-政治面貌
- 组织信息-单位名称
- 组织信息-部门名称
- 组织信息-部门路径
- 组织信息-班组名称
- 组织信息-岗位名称
- 组织信息-岗位层级
- 组织信息-岗位类别
- 组织信息-岗位专业分类
- 组织信息-岗位序列
- 职务信息-现任职务
- 职务信息-现任职务级别
- 技术专家-技术专家等级
- 技术专家-技术专家专业
- 技能专家-技能专家等级
- 技能专家-技能专家专业
- 员工工作信息-任职年限
- 员工工作信息-现任岗位聘任日期
- 员工工作信息-参加工作日期
- 员工工作信息-连续工龄起算日期
- 员工工作信息-入南网系统日期
- 员工工作信息-入本单位日期
- 员工联系信息-手机
- 学历学位教育-有学历学位教育-(入学日期,毕业日期,毕业院校,院校类别)
- 职称资格证书-多个职称资格证书-(资格名称,资格等级,专业名称,分支专业,资格取得时间,审批发证单位,是否当前证书,入库时间)
- 职称资格证书-当前-职称资格证书资格名称
- 职称资格证书-当前-职称资格证书资格等级
- 职称资格证书-当前-职称资格证书专业名称
- 职称资格证书-当前-职称资格证书分支专业
- 职称资格证书-当前-职称资格证书资格取得时间
- 职称资格证书-当前-职称资格证书审批发证单位
- 职称资格证书-当前-职称资格证书入库时间
- 岗位胜任能力资格证书-多个岗位胜任能力资格证书-(资格名称,岗位胜任能力证书等级,资格取得时间,审批发证单位,是否当前)
- 岗位胜任能力资格证书-当前-岗位胜任能力资格证书资格名称
- 岗位胜任能力资格证书-当前-岗位胜任能力证书等级
- 岗位胜任能力资格证书-当前-岗位胜任能力资格证书资格取得时间
- 岗位胜任能力资格证书-当前-岗位胜任能力资格证书审批发证单位
- 职业技能等级认定证书-多个职业技能等级认定证书-(资格名称,资格等级,工种名称,资格取得时间,审批发证单位,证书编号,入库时间,是否当前证书)
- 职业技能等级认定证书-当前-职业技能等级认定证书资格名称
- 职业技能等级认定证书-当前-职业技能等级认定证书资格等级
- 职业技能等级认定证书-当前-职业技能等级认定证书工种名称
- 职业技能等级认定证书-当前-职业技能等级认定证书资格取得时间
- 职业技能等级认定证书-当前-职业技能等级认定证书审批发证单位
- 职业技能等级认定证书-当前-职业技能等级认定证书证书编号
- 职业技能等级认定证书-当前-职业技能等级认定证书入库时间

## 数据库表结构

`employees`表包含以下主要字段组：

1. **基本信息**：姓名、员工编码、性别、出生日期、年龄等
2. **组织信息**：单位名称、部门名称、部门路径、班组名称、岗位名称等
3. **职务信息**：现任职务、职务级别
4. **专家信息**：技术专家等级、技能专家等级等
5. **工作信息**：任职年限、工作日期、入职日期等
6. **联系信息**：手机号码
7. **学历信息**：学历学位教育历史
8. **职称信息**：职称资格证书信息
9. **能力证书**：岗位胜任能力证书信息
10. **技能证书**：职业技能等级认定证书信息

## 故障排除

### 问题：导入过程中出现错误

可能原因：
- Excel文件中的字段名称与系统预期的不一致
- 数据格式不正确，特别是日期格式
- 数据库连接问题

解决方法：
1. 检查Excel文件中的字段名称，确保与要求的完全一致
2. 检查日期格式，确保是标准格式
3. 检查数据库连接信息是否正确

### 问题：查询结果为空

可能原因：
- 数据未成功导入
- 查询条件太严格

解决方法：
1. 使用查询工具检查数据库中是否有数据
2. 尝试使用更宽松的查询条件

## 前端集成

如果您需要在前端应用中使用这些数据，可以通过以下方式：

1. **创建API接口**：在服务器端创建API接口，用于查询员工数据
2. **前端调用API**：在前端应用中调用API获取数据
3. **数据展示**：使用表格、图表等方式展示数据

示例API接口：
```javascript
// 在server/routes/employees.js中添加
router.get('/api/employees', async (req, res) => {
  try {
    const connection = await mysql.createConnection(dbConfig);
    const [employees] = await connection.execute('SELECT * FROM employees LIMIT 100');
    await connection.end();
    res.json(employees);
  } catch (error) {
    res.status(500).json({ error: error.message });
  }
});
```

## 数据安全

请注意，员工信息属于敏感数据，应当采取适当的安全措施：

1. **访问控制**：限制数据库访问权限
2. **数据加密**：敏感字段（如手机号码）应当加密存储
3. **日志记录**：记录数据访问和修改操作
4. **定期备份**：定期备份数据库，防止数据丢失
