# 支部人员信息导入工具使用指南

这个工具专门用于导入包含员工基本信息的Excel表格，支持以下字段：

- 序号
- 员工基本信息-姓名
- 组织信息-部门路径
- 最高技能等级类别
- 最高技能等级工种
- 最高技能等级获取时间
- 最高技术等级类别
- 最高技术等级工种
- 最高技术等级获取时间
- 最高学历
- 年龄

## 使用方法

1. **准备Excel文件**：
   - 确保您的Excel文件包含上述字段
   - 字段名称必须与上述名称完全一致
   - 文件可以保存在任意位置

2. **运行导入工具**：
   ```bash
   cd D:\Projects\cursor\branch-analysis\server
   node import-personnel.js
   ```

3. **按照提示操作**：
   - 输入Excel文件的完整路径，例如：`D:\Data\personnel.xlsx`
   - 工具会自动读取文件、连接数据库并导入数据

4. **查看导入结果**：
   - 导入完成后，工具会显示成功和失败的记录数
   - 如果有失败的记录，会显示详细的错误信息

## 数据映射说明

导入工具会将Excel数据映射到数据库的`branch_personnel`表中，映射关系如下：

| Excel字段 | 数据库字段 |
|----------|-----------|
| 员工基本信息-姓名 | name |
| 组织信息-部门路径 | department_path |
| 最高技能等级类别 | skill_category |
| 最高技能等级工种 | skill_type |
| 最高技能等级获取时间 | skill_date |
| 最高技术等级类别 | tech_category |
| 最高技术等级工种 | tech_type |
| 最高技术等级获取时间 | tech_date |
| 最高学历 | education |
| 年龄 | age |

## 支部关联说明

工具会尝试从"组织信息-部门路径"字段中提取支部名称，并关联到对应的支部ID。

例如，如果部门路径为"公司/部门/技术创新党支部"，工具会尝试将该人员关联到"技术创新党支部"。

## 注意事项

1. **确保数据库已启动**：导入前确保MySQL数据库已启动并正常运行

2. **字段名称必须匹配**：Excel文件中的字段名称必须与上述名称完全一致

3. **日期格式**：日期字段应使用标准日期格式，例如"2023-01-01"或Excel日期格式

4. **支部关联**：为了正确关联支部，请确保"组织信息-部门路径"字段中包含完整的支部名称

## 故障排除

### 问题：导入工具无法读取Excel文件

可能原因：
- 文件路径不正确
- 文件格式不支持（仅支持.xlsx和.xls格式）

解决方法：
1. 检查文件路径是否正确
2. 确保文件是有效的Excel文件

### 问题：字段名称不匹配

可能原因：
- Excel文件中的字段名称与工具预期的不一致

解决方法：
1. 修改Excel文件中的字段名称，使其与工具预期的名称完全一致
2. 或者修改导入脚本中的字段映射定义

### 问题：无法关联到支部

可能原因：
- "组织信息-部门路径"字段中不包含有效的支部名称
- 支部名称与数据库中的不一致

解决方法：
1. 确保"组织信息-部门路径"字段中包含完整的支部名称
2. 检查数据库中的支部名称，确保与Excel中的一致
