# 模糊匹配Excel导入工具

这个工具可以读取Excel文件，通过模糊匹配将数据导入到数据库中。它支持字段名称的模糊匹配，自动处理数据类型转换，并能够智能识别工作表内容。

## 功能特点

- 支持字段名称的模糊匹配（例如："支部名称"可以匹配"党支部名称"）
- 自动识别工作表内容（基本信息、年龄分布、学历分布等）
- 自动处理数据类型转换
- 支持更新现有数据
- 详细的导入报告

## 使用方法

1. 准备Excel文件，包含以下工作表：
   - 支部基本信息（包含支部名称、书记、副书记等）
   - 年龄分布（可选）
   - 学历分布（可选）
   - 技能分布（可选）
   - 职称分布（可选）
   - 年度工作（可选）

2. 安装依赖：
   ```
   npm install string-similarity xlsx mysql2
   ```

3. 运行导入工具：
   ```
   cd branch-analysis/server
   node scripts/import-excel.js
   ```

4. 按照提示输入Excel文件路径

5. 确认字段映射并继续导入

6. 查看导入结果报告

## 创建模板

如果需要创建一个示例Excel模板，可以运行：
```
cd branch-analysis/server
node scripts/create-template.js
```

这将在server目录下生成一个名为`import_template.xlsx`的Excel文件，包含所有必要的工作表和示例数据。

## Excel文件格式要求

### 支部基本信息工作表
应包含以下字段（字段名称可以不完全一致，工具会进行模糊匹配）：
- 支部名称
- 书记
- 副书记
- 组织委员
- 纪检委员
- 宣传委员
- 学习委员
- 支部人数
- 平均年龄
- 上年度绩效
- 书记项目
- 获得荣誉

### 年龄分布工作表
应包含以下字段：
- 支部名称（用于关联支部）
- 18-28岁
- 28-35岁
- 35-50岁
- 50-60岁

### 学历分布工作表
应包含以下字段：
- 支部名称（用于关联支部）
- 大专及以下
- 本科
- 硕士
- 博士

### 技能分布工作表
应包含以下字段：
- 支部名称（用于关联支部）
- 初中级工
- 高级工
- 技师
- 高级技师

### 职称分布工作表
应包含以下字段：
- 支部名称（用于关联支部）
- 助理工程师
- 工程师
- 高级工程师
- 正高级工程师

### 年度工作工作表
应包含以下字段：
- 支部名称（用于关联支部）
- 工作任务
- 开始时间
- 结束时间
- 状态
- 进度

## 注意事项

- 确保数据库已正确设置并运行
- 工具会尝试智能识别工作表内容，但最好使用有意义的工作表名称
- 导入前会显示字段映射结果，请仔细检查
- 如果遇到错误，请查看错误报告
